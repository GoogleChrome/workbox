# sw-cache-expiration

This library is still a work in progress and is not functional.

## Installation

`npm install --save-dev sw-cache-expiration`

## Demo

Browse sample source code in the [demo directory](https://github.com/GoogleChrome/sw-helpers/tree/master/packages/sw-cache-expiration/demo), or
[try it out](https://googlechrome.github.io/sw-helpers/sw-cache-expiration/demo/) directly.

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### sw-cache-expiration

[packages/sw-cache-expiration/src/index.js:21-21](https://github.com/GoogleChrome/sw-helpers/blob/b592cf16d1ab0d89981f6f6b579b02b711856fd0/packages/sw-cache-expiration/src/index.js#L21-L21 "Source code on GitHub")

sw-cache-expiration Module

### Behavior

[packages/sw-cache-expiration/src/lib/behavior.js:52-293](https://github.com/GoogleChrome/sw-helpers/blob/b592cf16d1ab0d89981f6f6b579b02b711856fd0/packages/sw-cache-expiration/src/lib/behavior.js#L52-L293 "Source code on GitHub")

**Examples**

```javascript
// Used as an automatically invoked as "behavior" by a RequestWrapper:

const requestWrapper = new goog.runtimeCaching.RequestWrapper({
  cacheName: 'runtime-cache',
  behaviors: [
    new goog.cacheExpiration.Behavior({maxEntries: 10})
  ]
});

// Set up a route to match any requests made against the example.com domain.
// The requests will be handled with a stale-while-revalidate policy, and the
// cache size will be capped at 10 entries.
const route = new goog.routing.RegExpRoute({
  match: ({url}) => url.domain === 'example.com',
  handler: new goog.runtimeCaching.StaleWhileRevalidate({requestWrapper})
});
```

```javascript
// Explicitly invoked usage independent of the goog.routing framework, via
// the expireOldEntries() method:

// TODO: Write sample code.
```

### constructor

[packages/sw-cache-expiration/src/lib/behavior.js:63-78](https://github.com/GoogleChrome/sw-helpers/blob/b592cf16d1ab0d89981f6f6b579b02b711856fd0/packages/sw-cache-expiration/src/lib/behavior.js#L63-L78 "Source code on GitHub")

Creates a new `Behavior` instance, which is used to remove entries from a
[`Cache`](https://developer.mozilla.org/en-US/docs/Web/API/Cache) once
certain criteria—maximum number of entries, age of entry, or both—is met.

**Parameters**

-   `input` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The input object to this function.
    -   `input.maxEntries` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** The maximum size of the cache. Entries
               will be expired using a LRU policy once the cache reaches this size.
    -   `input.maxAgeSeconds` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** The maximum age for fresh entries.
-   `$0` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `
     `)
    -   `$0.maxEntries`  
    -   `$0.maxAgeSeconds`  

### updateTimestamp

[packages/sw-cache-expiration/src/lib/behavior.js:150-165](https://github.com/GoogleChrome/sw-helpers/blob/b592cf16d1ab0d89981f6f6b579b02b711856fd0/packages/sw-cache-expiration/src/lib/behavior.js#L150-L165 "Source code on GitHub")

Updates the timestamp stored in IndexedDB for `url` to be equal to `now`.

**Parameters**

-   `input` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The input object to this function.
    -   `input.cacheName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the cache the Responses belong to.
    -   `input.url` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `input.now` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** A timestamp. Defaults to the current time.
-   `$0` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `$0.cacheName`  
    -   `$0.url`  
    -   `$0.now`  

### expireEntries

[packages/sw-cache-expiration/src/lib/behavior.js:176-197](https://github.com/GoogleChrome/sw-helpers/blob/b592cf16d1ab0d89981f6f6b579b02b711856fd0/packages/sw-cache-expiration/src/lib/behavior.js#L176-L197 "Source code on GitHub")

Expires entries, both based on the the maximum age and the maximum number
of entries, depending on how this instance is configured.

**Parameters**

-   `input` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The input object to this function.
    -   `input.cacheName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the cache the Responses belong to.
    -   `input.now` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** A timestamp. Defaults to the current time.
-   `$0` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `
     `)
    -   `$0.cacheName`  
    -   `$0.now`  

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** A list of the URLs that were expired.
